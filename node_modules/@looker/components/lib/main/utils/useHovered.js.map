{"version":3,"file":"useHovered.js","names":["useHovered","hoverElement","useCallbackRef","newElement","callbackRef","element","useState","undefined","isHovered","setIsHovered","useEffect","handleMouseEnter","handleMouseLeave","window","requestAnimationFrame","node","getCurrentNode","relationship","document","activeElement","compareDocumentPosition","Node","DOCUMENT_POSITION_DISCONNECTED","activeElementIsChildOfNode","DOCUMENT_POSITION_FOLLOWING","DOCUMENT_POSITION_CONTAINED_BY","addEventListener","removeEventListener"],"sources":["../../../src/utils/useHovered.ts"],"sourcesContent":["/**\n * Copyright (c) 2023 Google LLC\n * SPDX-License-Identifier: MIT\n */\n\nimport type { RefObject } from 'react'\nimport { useEffect, useState } from 'react'\nimport { getCurrentNode } from './getCurrentNode'\nimport { useCallbackRef } from './useCallbackRef'\n\n/**\n * Get the hover / focus state of an element over which the current component has no control\n */\nexport function useHovered<E extends HTMLElement = HTMLElement>(\n  hoverElement?: E | null | RefObject<E>\n): [boolean, ((node: E | null) => void) | null] {\n  const [newElement, callbackRef] = useCallbackRef<E>()\n  const element =\n    typeof hoverElement === 'undefined' ? newElement : hoverElement\n\n  // If the hoverElement is either null nor a dom node, isHovered defaults to false\n\n  // (This works well except for the edge case where\n  // element is under the mouse at time of dom attachment.\n  // If handling this edge case is crucial, use React callbacks onMouseEnter and onMouseLeave\n  // instead of this hook)\n\n  // If the hoverElement is undefined the hover \"gate\" is not being used so\n  // isHovered defaults to true\n  const [isHovered, setIsHovered] = useState(hoverElement === undefined)\n\n  useEffect(() => {\n    function handleMouseEnter() {\n      setIsHovered(true)\n    }\n    function handleMouseLeave() {\n      window.requestAnimationFrame(() => {\n        const node = getCurrentNode(element)\n\n        const relationship =\n          document.activeElement && node\n            ? node.compareDocumentPosition(document.activeElement)\n            : Node.DOCUMENT_POSITION_DISCONNECTED\n\n        // Don't set isHovered to false if a child of the element is currently focused\n        const activeElementIsChildOfNode =\n          relationship ===\n          Node.DOCUMENT_POSITION_FOLLOWING + Node.DOCUMENT_POSITION_CONTAINED_BY\n\n        if (!activeElementIsChildOfNode) setIsHovered(false)\n      })\n    }\n\n    const node = getCurrentNode(element)\n    if (node) {\n      node.addEventListener('mouseleave', handleMouseLeave)\n      node.addEventListener('mouseenter', handleMouseEnter)\n      node.addEventListener('focusout', handleMouseLeave)\n      node.addEventListener('focusin', handleMouseEnter)\n    }\n    return () => {\n      if (node) {\n        node.removeEventListener('mouseleave', handleMouseLeave)\n        node.removeEventListener('mouseenter', handleMouseEnter)\n        node.removeEventListener('focusout', handleMouseLeave)\n        node.removeEventListener('focusin', handleMouseEnter)\n      }\n    }\n  }, [element])\n\n  return [isHovered, callbackRef]\n}\n"],"mappings":";;;;;;;;AAMA;AACA;AACA;;AAKO,SAASA,UAAU,CACxBC,YAAsC,EACQ;EAC9C,sBAAkC,IAAAC,+BAAc,GAAK;IAAA;IAA9CC,UAAU;IAAEC,WAAW;EAC9B,IAAMC,OAAO,GACX,OAAOJ,YAAY,KAAK,WAAW,GAAGE,UAAU,GAAGF,YAAY;;EAWjE,gBAAkC,IAAAK,eAAQ,EAACL,YAAY,KAAKM,SAAS,CAAC;IAAA;IAA/DC,SAAS;IAAEC,YAAY;EAE9B,IAAAC,gBAAS,EAAC,YAAM;IACd,SAASC,gBAAgB,GAAG;MAC1BF,YAAY,CAAC,IAAI,CAAC;IACpB;IACA,SAASG,gBAAgB,GAAG;MAC1BC,MAAM,CAACC,qBAAqB,CAAC,YAAM;QACjC,IAAMC,IAAI,GAAG,IAAAC,8BAAc,EAACX,OAAO,CAAC;QAEpC,IAAMY,YAAY,GAChBC,QAAQ,CAACC,aAAa,IAAIJ,IAAI,GAC1BA,IAAI,CAACK,uBAAuB,CAACF,QAAQ,CAACC,aAAa,CAAC,GACpDE,IAAI,CAACC,8BAA8B;;QAGzC,IAAMC,0BAA0B,GAC9BN,YAAY,KACZI,IAAI,CAACG,2BAA2B,GAAGH,IAAI,CAACI,8BAA8B;QAExE,IAAI,CAACF,0BAA0B,EAAEd,YAAY,CAAC,KAAK,CAAC;MACtD,CAAC,CAAC;IACJ;IAEA,IAAMM,IAAI,GAAG,IAAAC,8BAAc,EAACX,OAAO,CAAC;IACpC,IAAIU,IAAI,EAAE;MACRA,IAAI,CAACW,gBAAgB,CAAC,YAAY,EAAEd,gBAAgB,CAAC;MACrDG,IAAI,CAACW,gBAAgB,CAAC,YAAY,EAAEf,gBAAgB,CAAC;MACrDI,IAAI,CAACW,gBAAgB,CAAC,UAAU,EAAEd,gBAAgB,CAAC;MACnDG,IAAI,CAACW,gBAAgB,CAAC,SAAS,EAAEf,gBAAgB,CAAC;IACpD;IACA,OAAO,YAAM;MACX,IAAII,IAAI,EAAE;QACRA,IAAI,CAACY,mBAAmB,CAAC,YAAY,EAAEf,gBAAgB,CAAC;QACxDG,IAAI,CAACY,mBAAmB,CAAC,YAAY,EAAEhB,gBAAgB,CAAC;QACxDI,IAAI,CAACY,mBAAmB,CAAC,UAAU,EAAEf,gBAAgB,CAAC;QACtDG,IAAI,CAACY,mBAAmB,CAAC,SAAS,EAAEhB,gBAAgB,CAAC;MACvD;IACF,CAAC;EACH,CAAC,EAAE,CAACN,OAAO,CAAC,CAAC;EAEb,OAAO,CAACG,SAAS,EAAEJ,WAAW,CAAC;AACjC"}