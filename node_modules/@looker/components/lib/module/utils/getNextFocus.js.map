{"version":3,"file":"getNextFocus.js","names":["getTabStops","ref","selector","Array","from","querySelectorAll","getFallbackElement","direction","containerElement","tabStops","fallback","firstVisibleChild","find","childElement","offsetTop","scrollTop","length","getNextFocus","element","focusedElement","document","activeElement","HTMLElement","includes","next","findIndex","el"],"sources":["../../../src/utils/getNextFocus.ts"],"sourcesContent":["/**\n * Copyright (c) 2023 Google LLC\n * SPDX-License-Identifier: MIT\n */\n\nexport const getTabStops = (\n  ref: HTMLElement,\n  selector = 'a,button:not(:disabled),[tabindex=\"0\"],[tabindex=\"-1\"]:not(:disabled)'\n): HTMLElement[] => Array.from(ref.querySelectorAll(selector))\n\n// Returns a fallback element (called when the element with focus has been removed from the DOM)\nexport const getFallbackElement = (\n  direction: 1 | -1,\n  containerElement: HTMLElement,\n  tabStops: HTMLElement[]\n) => {\n  let fallback: HTMLElement\n\n  if (direction === 1) {\n    const firstVisibleChild = tabStops.find(childElement => {\n      return childElement.offsetTop >= containerElement.scrollTop\n      return false\n    })\n\n    if (firstVisibleChild) fallback = firstVisibleChild\n    else fallback = tabStops[0]\n  } else {\n    fallback = tabStops[tabStops.length - 1]\n  }\n\n  return fallback\n}\n\n/**\n * Returns the next focusable inside an element in a given direction\n * @param direction 1 for forward -1 for reverse\n * @param element the container element\n */\nexport const getNextFocus = (direction: 1 | -1, element: HTMLElement) => {\n  const tabStops = getTabStops(element)\n\n  const focusedElement = document.activeElement\n\n  if (tabStops.length > 0 && focusedElement instanceof HTMLElement) {\n    if (tabStops.includes(focusedElement)) {\n      const next =\n        tabStops.findIndex(el => el === document.activeElement) + direction\n\n      if (next === tabStops.length || !tabStops[next]) {\n        // Reached the end of tab stops for this direction\n        return getFallbackElement(direction, element, tabStops)\n      }\n\n      return tabStops[next]\n    }\n    return getFallbackElement(direction, element, tabStops)\n  }\n  return null\n}\n"],"mappings":";;AAKA,OAAO,MAAMA,WAAW,GAAG,CACzBC,GAAgB,EAChBC,QAAQ,GAAG,uEAAuE,KAChEC,KAAK,CAACC,IAAI,CAACH,GAAG,CAACI,gBAAgB,CAACH,QAAQ,CAAC,CAAC;;AAG9D,OAAO,MAAMI,kBAAkB,GAAG,CAChCC,SAAiB,EACjBC,gBAA6B,EAC7BC,QAAuB,KACpB;EACH,IAAIC,QAAqB;EAEzB,IAAIH,SAAS,KAAK,CAAC,EAAE;IACnB,MAAMI,iBAAiB,GAAGF,QAAQ,CAACG,IAAI,CAACC,YAAY,IAAI;MACtD,OAAOA,YAAY,CAACC,SAAS,IAAIN,gBAAgB,CAACO,SAAS;MAC3D,OAAO,KAAK;IACd,CAAC,CAAC;IAEF,IAAIJ,iBAAiB,EAAED,QAAQ,GAAGC,iBAAiB,MAC9CD,QAAQ,GAAGD,QAAQ,CAAC,CAAC,CAAC;EAC7B,CAAC,MAAM;IACLC,QAAQ,GAAGD,QAAQ,CAACA,QAAQ,CAACO,MAAM,GAAG,CAAC,CAAC;EAC1C;EAEA,OAAON,QAAQ;AACjB,CAAC;;AAOD,OAAO,MAAMO,YAAY,GAAG,CAACV,SAAiB,EAAEW,OAAoB,KAAK;EACvE,MAAMT,QAAQ,GAAGT,WAAW,CAACkB,OAAO,CAAC;EAErC,MAAMC,cAAc,GAAGC,QAAQ,CAACC,aAAa;EAE7C,IAAIZ,QAAQ,CAACO,MAAM,GAAG,CAAC,IAAIG,cAAc,YAAYG,WAAW,EAAE;IAChE,IAAIb,QAAQ,CAACc,QAAQ,CAACJ,cAAc,CAAC,EAAE;MACrC,MAAMK,IAAI,GACRf,QAAQ,CAACgB,SAAS,CAACC,EAAE,IAAIA,EAAE,KAAKN,QAAQ,CAACC,aAAa,CAAC,GAAGd,SAAS;MAErE,IAAIiB,IAAI,KAAKf,QAAQ,CAACO,MAAM,IAAI,CAACP,QAAQ,CAACe,IAAI,CAAC,EAAE;QAE/C,OAAOlB,kBAAkB,CAACC,SAAS,EAAEW,OAAO,EAAET,QAAQ,CAAC;MACzD;MAEA,OAAOA,QAAQ,CAACe,IAAI,CAAC;IACvB;IACA,OAAOlB,kBAAkB,CAACC,SAAS,EAAEW,OAAO,EAAET,QAAQ,CAAC;EACzD;EACA,OAAO,IAAI;AACb,CAAC"}