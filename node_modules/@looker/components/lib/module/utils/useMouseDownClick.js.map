{"version":3,"file":"useMouseDownClick.js","names":["useEffect","useRef","useCallback","useMouseDownClick","onMouseDownClick","onMouseUp","mouseDownTriggered","handleMouseUp","e","window","requestAnimationFrame","current","document","removeEventListener","onClick","onMouseDown","addEventListener"],"sources":["../../../src/utils/useMouseDownClick.ts"],"sourcesContent":["/**\n * Copyright (c) 2023 Google LLC\n * SPDX-License-Identifier: MIT\n */\n\n// This hook allows you to merge click and mousedown behavior to a single callback\n// which will trigger on mousedown or on click if mousedown has not already been triggered\n// onMouseUp is an optional callback parameter for any necessary cleanup or cancellations\n// because the user changed their mind and dragged out of the element before mouseup\n\nimport type { MouseEvent as ReactMouseEvent } from 'react'\nimport { useEffect, useRef, useCallback } from 'react'\n/**\n * @param onMouseDownClick callback with React.MouseEvent for the first of either mousedown OR click\n * @param onMouseUp callback with DOM MouseEvent for mouseup (may be outside the element)\n */\nexport function useMouseDownClick<E extends HTMLElement>(\n  onMouseDownClick: (e: ReactMouseEvent<E>) => void,\n  onMouseUp?: (e: MouseEvent) => void\n) {\n  const mouseDownTriggered = useRef(false)\n\n  // User may hold the mouse down for an unspecified length of time\n  // and they may drag out of the element in question before mouseup\n  // in which case, onMouseDown has been called but not onClick\n  // so we need to provide the opportunity to \"reverse\" the action (e.g. close the menu)\n  const handleMouseUp = useCallback(\n    (e: MouseEvent) => {\n      window.requestAnimationFrame(() => {\n        mouseDownTriggered.current = false\n        onMouseUp && onMouseUp(e)\n      })\n    },\n    [onMouseUp]\n  )\n\n  useEffect(() => {\n    return () => {\n      document.removeEventListener('mouseup', handleMouseUp)\n    }\n  }, [handleMouseUp])\n\n  return {\n    onClick: useCallback(\n      (e: ReactMouseEvent<E>) => {\n        if (!mouseDownTriggered.current) {\n          onMouseDownClick(e)\n        }\n      },\n      [onMouseDownClick]\n    ),\n    onMouseDown: useCallback(\n      (e: ReactMouseEvent<E>) => {\n        mouseDownTriggered.current = true\n        onMouseDownClick(e)\n        document.addEventListener('mouseup', handleMouseUp)\n      },\n      [handleMouseUp, onMouseDownClick]\n    ),\n  }\n}\n"],"mappings":";;AAWA,SAASA,SAAS,EAAEC,MAAM,EAAEC,WAAW,QAAQ,OAAO;AAKtD,OAAO,SAASC,iBAAiB,CAC/BC,gBAAiD,EACjDC,SAAmC,EACnC;EACA,MAAMC,kBAAkB,GAAGL,MAAM,CAAC,KAAK,CAAC;;EAMxC,MAAMM,aAAa,GAAGL,WAAW,CAC9BM,CAAa,IAAK;IACjBC,MAAM,CAACC,qBAAqB,CAAC,MAAM;MACjCJ,kBAAkB,CAACK,OAAO,GAAG,KAAK;MAClCN,SAAS,IAAIA,SAAS,CAACG,CAAC,CAAC;IAC3B,CAAC,CAAC;EACJ,CAAC,EACD,CAACH,SAAS,CAAC,CACZ;EAEDL,SAAS,CAAC,MAAM;IACd,OAAO,MAAM;MACXY,QAAQ,CAACC,mBAAmB,CAAC,SAAS,EAAEN,aAAa,CAAC;IACxD,CAAC;EACH,CAAC,EAAE,CAACA,aAAa,CAAC,CAAC;EAEnB,OAAO;IACLO,OAAO,EAAEZ,WAAW,CACjBM,CAAqB,IAAK;MACzB,IAAI,CAACF,kBAAkB,CAACK,OAAO,EAAE;QAC/BP,gBAAgB,CAACI,CAAC,CAAC;MACrB;IACF,CAAC,EACD,CAACJ,gBAAgB,CAAC,CACnB;IACDW,WAAW,EAAEb,WAAW,CACrBM,CAAqB,IAAK;MACzBF,kBAAkB,CAACK,OAAO,GAAG,IAAI;MACjCP,gBAAgB,CAACI,CAAC,CAAC;MACnBI,QAAQ,CAACI,gBAAgB,CAAC,SAAS,EAAET,aAAa,CAAC;IACrD,CAAC,EACD,CAACA,aAAa,EAAEH,gBAAgB,CAAC;EAErC,CAAC;AACH"}