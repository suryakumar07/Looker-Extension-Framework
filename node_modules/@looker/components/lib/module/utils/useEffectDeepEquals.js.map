{"version":3,"file":"useEffectDeepEquals.js","names":["React","isEqual","checkDeps","deps","length","Error","every","isPrimitive","val","test","useDeepCompareMemoize","value","ref","useRef","signalRef","current","useMemo","useEffectDeepEquals","callback","dependencies","process","env","NODE_ENV","useEffect"],"sources":["../../../src/utils/useEffectDeepEquals.ts"],"sourcesContent":["/**\n * Copyright (c) 2023 Google LLC\n * SPDX-License-Identifier: MIT\n */\n\nimport React from 'react'\nimport isEqual from 'lodash/isEqual'\n\ntype UseEffectParams = Parameters<typeof React.useEffect>\ntype EffectCallback = UseEffectParams[0]\ntype DependencyList = UseEffectParams[1]\n\nfunction checkDeps(deps: DependencyList) {\n  if (!deps || !deps.length) {\n    throw new Error(\n      'useEffectDeepEquals should not be used with no dependencies. Use React.useEffect instead.'\n    )\n  }\n  if (deps.every(isPrimitive)) {\n    throw new Error(\n      'useEffectDeepEquals should not be used with dependencies that are all primitive values. Use React.useEffect instead.'\n    )\n  }\n}\n\nfunction isPrimitive(val: unknown) {\n  return val == null || /^[sbn]/.test(typeof val)\n}\n\n/**\n * @param value the value to be memoized (usually a dependency list)\n * @returns a memoized version of the value as long as it remains deeply equal\n */\nexport function useDeepCompareMemoize<T>(value: T) {\n  const ref = React.useRef<T>(value)\n  const signalRef = React.useRef<number>(0)\n\n  if (!isEqual(value, ref.current)) {\n    ref.current = value\n    signalRef.current += 1\n  }\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  return React.useMemo(() => ref.current, [signalRef.current])\n}\n\n/**\n * An alternative rewrite to useEffect for situations where you need\n * to compare complex, deeply nested objects in the dependency array.\n *\n * @param callback function to call when dependencies change\n * @param dependencies an array of objects to compare\n */\n\nexport const useEffectDeepEquals = (\n  callback: EffectCallback,\n  dependencies: DependencyList\n): void => {\n  if (process.env.NODE_ENV !== 'production') {\n    checkDeps(dependencies)\n  }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  return React.useEffect(callback, useDeepCompareMemoize(dependencies))\n}\n"],"mappings":";;AAKA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAOC,OAAO,MAAM,gBAAgB;AAMpC,SAASC,SAAS,CAACC,IAAoB,EAAE;EACvC,IAAI,CAACA,IAAI,IAAI,CAACA,IAAI,CAACC,MAAM,EAAE;IACzB,MAAM,IAAIC,KAAK,CACb,2FAA2F,CAC5F;EACH;EACA,IAAIF,IAAI,CAACG,KAAK,CAACC,WAAW,CAAC,EAAE;IAC3B,MAAM,IAAIF,KAAK,CACb,sHAAsH,CACvH;EACH;AACF;AAEA,SAASE,WAAW,CAACC,GAAY,EAAE;EACjC,OAAOA,GAAG,IAAI,IAAI,IAAI,QAAQ,CAACC,IAAI,CAAC,OAAOD,GAAG,CAAC;AACjD;;AAMA,OAAO,SAASE,qBAAqB,CAAIC,KAAQ,EAAE;EACjD,MAAMC,GAAG,GAAGZ,KAAK,CAACa,MAAM,CAAIF,KAAK,CAAC;EAClC,MAAMG,SAAS,GAAGd,KAAK,CAACa,MAAM,CAAS,CAAC,CAAC;EAEzC,IAAI,CAACZ,OAAO,CAACU,KAAK,EAAEC,GAAG,CAACG,OAAO,CAAC,EAAE;IAChCH,GAAG,CAACG,OAAO,GAAGJ,KAAK;IACnBG,SAAS,CAACC,OAAO,IAAI,CAAC;EACxB;;EAGA,OAAOf,KAAK,CAACgB,OAAO,CAAC,MAAMJ,GAAG,CAACG,OAAO,EAAE,CAACD,SAAS,CAACC,OAAO,CAAC,CAAC;AAC9D;;AAUA,OAAO,MAAME,mBAAmB,GAAG,CACjCC,QAAwB,EACxBC,YAA4B,KACnB;EACT,IAAIC,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,YAAY,EAAE;IACzCpB,SAAS,CAACiB,YAAY,CAAC;EACzB;EAEA,OAAOnB,KAAK,CAACuB,SAAS,CAACL,QAAQ,EAAER,qBAAqB,CAACS,YAAY,CAAC,CAAC;AACvE,CAAC"}